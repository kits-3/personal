CREATE DATABASE ATM_Machine;

/*Delete table*/
DROP TABLE user;
DROP TABLE ACCOUNT;

CREATE TABLE USER(
   userID BIGINT NOT NULL AUTO_INCREMENT,
	userName VARCHAR(255) NOT NULL,
	age INTEGER NOT NULL,
	sex VARCHAR(255) NOT NULL,
	phoneNumber VARCHAR(255) NOT NULL,
   address VARCHAR(255) NOT NULL,
   PRIMARY KEY(userID)
);

CREATE TABLE ACCOUNT(
   accountID BIGINT NOT NULL AUTO_INCREMENT,
   pinCode INTEGER NOT NULL,
	accountName VARCHAR(255) NOT NULL,
	availableBalance DOUBLE NOT NULL,
	totalBalance DOUBLE NOT NULL,
	accountTypeID INTEGER NOT NULL,
	userID BIGINT NOT NULL,
	roleID INTEGER NOT NULL,
	locationID INTEGER NOT NULL,
	PRIMARY KEY(accountID),
	FOREIGN KEY (userID) REFERENCES user(userID),
	FOREIGN KEY (roleID) REFERENCES role(roleID),
	FOREIGN KEY (locationID) REFERENCES location(locationID),
	FOREIGN KEY (accountTypeID) REFERENCES accounttype(accountTypeID)
);

CREATE TABLE ATMmachine(
   machineID INTEGER NOT NULL AUTO_INCREMENT,
   machineName VARCHAR(255) NOT NULL,
	locationID INTEGER NOT NULL,
	PRIMARY KEY(machineID),
	FOREIGN KEY (locationID) REFERENCES location(locationID)
);

CREATE TABLE LOCATION(
   locationID INTEGER NOT NULL AUTO_INCREMENT,
   locationName VARCHAR(255) NOT NULL,
	PRIMARY KEY(locationID)
);

CREATE TABLE ROLE(
   roleID INTEGER NOT NULL AUTO_INCREMENT,
   roleName VARCHAR(255) NOT NULL,
	PRIMARY KEY(roleID)
);

CREATE TABLE ACCOUNTTYPE (
   accountTypeID INTEGER NOT NULL AUTO_INCREMENT,
   accountTypeName VARCHAR(255) NOT NULL,
	PRIMARY KEY(accountTypeID)
);

CREATE TABLE TRANSACTION (
   transactionID BIGINT NOT NULL AUTO_INCREMENT,
   loaiGiaoDich VARCHAR(255) DEFAULT NULL,
   description VARCHAR(255) DEFAULT NULL,
   date_transaction VARCHAR(255) DEFAULT NULL,
   accountID BIGINT DEFAULT NULL,
   accountReceived BIGINT DEFAULT NULL,
   moneySend DOUBLE DEFAULT NULL,
   addedMoney DOUBLE DEFAULT NULL,
   withdrawlMoney DOUBLE DEFAULT NULL,
   oldPIN INTEGER DEFAULT NULL,
   newPIN INTEGER DEFAULT NULL,
	PRIMARY KEY(transactionID),
	FOREIGN KEY (accountID) REFERENCES account(accountID),
   FOREIGN KEY (accountReceived) REFERENCES account(accountID)
);


CREATE TABLE COINS (
   coinID INTEGER NOT NULL AUTO_INCREMENT,
   priceTag INTEGER NOT NULL,
   quantity BIGINT NOT NULL,
   machineID INTEGER NOT NULL,
	PRIMARY KEY(coinID),
	FOREIGN KEY (machineID) REFERENCES atmmachine(machineID)
);


